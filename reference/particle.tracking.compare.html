<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Track the movement of biomass as passive drifters — particle.tracking.compare • BiomassTracking</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Track the movement of biomass as passive drifters — particle.tracking.compare"><meta property="og:description" content="This functions tracks the movement of biomass through the given polygons by
following the proportionate distribution of a large number of passive
drifter (small fluid parcels) trajectories, which are calculated using a
4th-order Runge-Kutta integration scheme."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BiomassTracking</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Track the movement of biomass as passive drifters</h1>
    
    <div class="hidden name"><code>particle.tracking.compare.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This functions tracks the movement of biomass through the given polygons by
following the proportionate distribution of a large number of passive
drifter (small fluid parcels) trajectories, which are calculated using a
4th-order Runge-Kutta integration scheme.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">particle.tracking.compare</span><span class="op">(</span><span class="va">arena</span>, <span class="va">num_particles</span>, <span class="va">t_step</span>, <span class="va">end_t_counter</span>,</span>
<span>  start_setup <span class="op">=</span> <span class="cn">NULL</span>, infl_poly <span class="op">=</span> <span class="fl">1</span>, infl_time <span class="op">=</span> <span class="fl">10</span>, subdiv <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  diffusion <span class="op">=</span> <span class="fl">0</span>, silent <span class="op">=</span> <span class="cn">TRUE</span>, graphics <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>arena</dt>
<dd><p>An object of class <code>arena</code>, see details.</p></dd>


<dt>num_particles</dt>
<dd><p>The number of particles used.</p></dd>


<dt>t_step</dt>
<dd><p>The time step in which the results should be presented.</p></dd>


<dt>end_t_counter</dt>
<dd><p>The number of time steps that should be recorded.</p></dd>


<dt>start_setup</dt>
<dd><p>A vector giving a starting biomass distribution. Specify
either this or the next two arguments.</p></dd>


<dt>infl_poly</dt>
<dd><p>The polygon into which the biomass enters. Has to have
positive inflow from the outside.</p></dd>


<dt>infl_time</dt>
<dd><p>The number of time steps over which the biomass is to be
inserted.</p></dd>


<dt>subdiv</dt>
<dd><p>The number of Runge-Kutta time steps per recorded time step.
See details for the default value.</p></dd>


<dt>diffusion</dt>
<dd><p>The coefficient of diffusion, see details.</p></dd>


<dt>silent</dt>
<dd><p>If silent is FALSE, the movement of the biomass will be shown
graphically, with the user having to hit 'enter' after every time step</p></dd>


<dt>graphics</dt>
<dd><p>If graphics is TRUE, the remaining particles at the end will
be shown. A plot of of the arena has to be done before.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A matrix of dimension 'number of polygons' x 'number of time steps',
where the last polygon is the 'outside'. Each column holds the biomass
distribution in the respective time step.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>There are two different starting conditions for the flow of biomass: A
starting distribution can be given or the biomass can flow into the area
through a specified inflow polygon in a certain number of time steps.</p>
<p>A call to the C-function <code>particle\_tracking\_compare\_inflow</code> does the
bulk of work, which is a lot faster than the same implementation in R due to
the greatly increased efficiency of 'for' loops. It is important to note
that in the present form, particles can get caught in 'voids' in the flow
field, i.e. in places where their velocity is 0. If this happens for too
many particles (a warnings message is given at the end, indicating the
number of particles left in the domain), the estimation should be repeated
with a higher values of diffusion.</p>
<p>There is considerable space for improvement in replacing the fixed time step
Runge-Kutta scheme with a more sophisticated numerical integrator. However,
this requires some fiddling with the underlying C functions and has not been
tried yet.</p>
<p>An <code>arena</code> object describes the arena in which the function is to be
used. It is a list containing elements <code>lat</code>, <code>lon</code>, <code>U</code>,
<code>V</code> and <code>S</code> (in that order), where <code>lat</code> and <code>lon</code> are
vectors storing the latitude and longitude values of the grid points used,
<code>U</code> and <code>V</code> are matrices with the corresponding flow velocities in
west-east and south-north direction, and <code>S</code> is a matrix in which each
grid points has an integer number, either giving the polygon it belongs to
(if &gt; 0) or stating that this grid point lies on land (if == 0).</p>
<p>The default value for <code>subdiv</code> is choosen in such a way that a particle
will on average move for 1/10 of the distance between two grid points in
each time step. Although a variable time step would be preferable, this
yields an accurate estimation in most cases.</p>
<p>Diffusion is included by adding the product of a normal random variable and
the mean velocity to the calculated velocity in either direction. The
diffusion coefficient gives the standard variation of the normal random
number. Diffusion is needed to get particles out of 'voids', i.e. places in
the flow field where the adjacent velocities cancel out and the particles
get stuck.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>TODO: My report</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="biomass.tracking.html">biomass.tracking</a></code>,
<code>particle.tracking.compare</code>, <code><a href="biomass.compare.html">biomass.compare</a></code>,
<code><a href="prepare.arena.html">prepare.arena</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Thorsten Lenser</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Udata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Vdata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Sdata</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">arena</span> <span class="op">=</span> <span class="fu"><a href="prepare.arena.html">prepare.arena</a></span><span class="op">(</span><span class="va">Udata</span>,<span class="va">Vdata</span>,<span class="va">Sdata</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">arena</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use more particles if realistic results are needed</span></span></span>
<span class="r-in"><span><span class="va">mk</span> <span class="op">=</span> <span class="fu"><a href="particle.tracking.html">particle.tracking</a></span><span class="op">(</span><span class="va">arena</span>,<span class="fl">400</span>,<span class="fl">5000</span>,diffusion<span class="op">=</span><span class="fl">0.6</span>,graphics<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="particle.tracking.compare-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now estimate the biomass movement</span></span></span>
<span class="r-in"><span><span class="va">N1</span> <span class="op">=</span> <span class="fu"><a href="biomass.tracking.html">biomass.tracking</a></span><span class="op">(</span><span class="va">mk</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">4900</span>,by<span class="op">=</span><span class="fl">100</span><span class="op">)</span>,infl_poly<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get a particle tracking result to compare the above to</span></span></span>
<span class="r-in"><span><span class="va">N2</span> <span class="op">=</span> <span class="fu">particle.tracking.compare</span><span class="op">(</span><span class="va">arena</span>,<span class="fl">400</span>,<span class="fl">100</span>,<span class="fl">50</span>,diffusion<span class="op">=</span><span class="fl">0.6</span>,infl_poly<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Particles left in domain after the time for particle tracking elapsed: </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>33</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare the results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="biomass.compare.html">biomass.compare</a></span><span class="op">(</span><span class="va">N1</span>,<span class="va">N2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="particle.tracking.compare-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 49.627705  2.090415</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Thorsten Lenser, Michael D. Sumner.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

